import { check, colorOn, not } from '../assert';
import { IncompleteLevel, IncompleteStage } from '../interfaces';
import { createLevel } from '../level';
import { arrow, checkShapes, concat, initial } from '../shapes';

const levels: IncompleteLevel[] = [
  {
    goal: 'ifYourKingIsAttacked',
    sfen: '9/9/9/9/4r4/9/9/9/4K4 b - 1',
    nbMoves: 1,
    success: not(check('sente')),
    failure: check('sente'),
    drawShapes: concat(initial([arrow('5e', '5i', 'red')]), checkShapes),
    offerIllegalDests: true,
  },
  {
    goal: 'escapeWithTheKing',
    sfen: '9/9/9/9/9/9/9/2s1r4/3K5 b - 1',
    nbMoves: 1,
    success: not(check('sente')),
    failure: check('sente'),
    drawShapes: checkShapes,
    offerIllegalDests: true,
  },
  {
    goal: 'theKingCannotEscapeButBlock',
    sfen: '9/9/9/9/9/9/6PPP/4+r2K1/6SNL b - 1',
    nbMoves: 1,
    success: not(check('sente')),
    failure: check('sente'),
    drawShapes: checkShapes,
    offerIllegalDests: true,
  },
  {
    goal: 'theKingCannotEscapeButBlock',
    sfen: '9/9/9/9/9/9/6PPP/5+r1K1/7NL b G 1',
    nbMoves: 1,
    success: not(check('sente')),
    failure: check('sente'),
    drawShapes: checkShapes,
    offerIllegalDests: true,
  },
  {
    goal: 'theKingCannotEscapeButBlock',
    sfen: '9/9/9/9/5b3/9/6B1P/8K/6sNL b P 1',
    nbMoves: 1,
    success: not(check('sente')),
    failure: check('sente'),
    drawShapes: checkShapes,
    offerIllegalDests: true,
  },
  {
    goal: 'youCanGetOutOfCheckByTaking',
    sfen: '9/9/9/9/9/9/6PPp/5+p1KP/5GbNL b - 1',
    nbMoves: 1,
    success: not(check('sente')),
    failure: check('sente'),
    drawShapes: checkShapes,
    offerIllegalDests: true,
  },
  {
    goal: 'getOutOfCheck',
    sfen: '9/9/9/9/9/9/3Ss4/3s5/3K5 b - 1',
    nbMoves: 1,
    success: not(check('sente')),
    failure: check('sente'),
    drawShapes: checkShapes,
    offerIllegalDests: true,
  },
  {
    goal: 'getOutOfCheck',
    sfen: '9/9/9/7p1/8b/4sPK2/6g2/9/9 b - 1',
    nbMoves: 1,
    success: not(check('sente')),
    failure: check('sente'),
    drawShapes: checkShapes,
    offerIllegalDests: true,
  },
  {
    goal: 'getOutOfCheck',
    sfen: '9/9/9/6n2/6p2/5Ks2/9/4r4/9 b - 1',
    nbMoves: 1,
    success: not(check('sente')),
    failure: check('sente'),
    drawShapes: checkShapes,
    offerIllegalDests: true,
  },
  {
    goal: 'getOutOfCheck',
    sfen: '9/9/9/9/8P/8l/7P1/6rSK/7NL b P 1',
    nbMoves: 1,
    success: not(check('sente')),
    failure: check('sente'),
    drawShapes: checkShapes,
    offerIllegalDests: true,
  },
  {
    goal: 'watchOutForYourOpponentsReply',
    sfen: '9/9/9/9/9/4b4/PPG6/LS7/K4r3 b L 1',
    nbMoves: 1,
    success: not(check('sente')),
    failure: check('sente'),
    drawShapes: checkShapes,
    offerIllegalDests: true,
  },
  {
    goal: 'watchOutForYourOpponentsReply',
    sfen: '9/9/9/9/9/5+bn2/5GPPP/6SK1/5G1NL b g 1',
    nbMoves: 1,
    success: colorOn('sente', '3f'),
    failure: not(colorOn('sente', '3f')),
    drawShapes: checkShapes,
    offerIllegalDests: true,
    showFailureMove: () => 'G*2h',
  },
];
const stage: IncompleteStage = {
  key: 'outOfCheck',
  title: 'outOfCheck',
  subtitle: 'defendYourKing',
  intro: 'outOfCheckIntro',
  levels: levels.map((l, i) => createLevel(l, i)),
  complete: 'outOfCheckComplete',
};

export default stage;
